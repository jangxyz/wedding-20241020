import{g as l,d as r,c as m,b as w,T as y,r as k,a as L}from"./init_firebase.C2PdSPqF.js";import{z as d}from"./index.DXqQCM1T.js";import{o as T}from"./utils.vkuU_gs0.js";import{n as p}from"./firebase_utils.uA8kCWMc.js";import{f as b}from"./modalPortal-action.q8WiRC-G.js";d.object({likes:d.record(d.string(),d.any())});const f="photo_likes";async function C(a,t){const o=l(),e=r(o,"wedding",p(a)),s=m(e,f),c=r(s,t),n=await L(c);return console.log("ðŸš€ ~ file: like_photo.ts:52 ~ loadPhotoLikes ~ snapshot:",n),[g(n),n]}async function F(a){const t=l(),o=r(t,"wedding",p(a)),e=m(o,f),s=await w(e);return[s.docs.map(n=>g(n)),s]}async function H(a,t,o){const e=l(),s=y.now();return await k(e,async c=>{const n=r(e,"wedding",p(a)),D=m(n,f),h=r(D,t);let u=await c.get(h),i={};u.exists()&&(i=u.data().likes??{}),i[o]?delete i[o]:i[o]=s,c.set(h,{likes:i,updatedTimestamp:s})}),await C(a,t)}function g(a){const t=a.data();if(!t)return null;const o=t.updatedTimestamp.toDate(),e=b(o,"yyyy-M-d HH:mm");return{...T(t,"createdTimestamp"),id:a.id,updatedDate:o,updatedDateStr:e}}export{F as loadAllPhotoLikes,C as loadPhotoLikes,H as togglePhotoLike};
